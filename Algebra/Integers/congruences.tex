\chapter{Congruenze tra interi}

\section{Definizione di congruenza}

\begin{definition}
    [Congruenza modulo $n$]
    Siano $a, b, n \in \Z$ con $n \geq 2$. Allora si dice che $a$ è \emph{congruo a $b$ modulo $n$}, e si scrive \[
        a \congr b \pmod{n},  \quad \text{oppure }  a \congr b \Mod{n}
    \] se vale che $n \divides a - b$. 
\end{definition}

\begin{proposition}
    [La congruenza modulo $n$ è un'equivalenza]
    Sia $n \in \Z$, $n \geq 2$. Allora la relazione di congruenza modulo $n$ è una relazione di equivalenza su $\Z$.
\end{proposition}
\begin{proof}
    Dimostriamo che valgono le proprietà delle relazioni di equivalenza.
    \begin{description}
        \item[Riflessività] Sia $a \in \Z$. Allora $a \congr a \Mod{n}$ in quanto $n \divides a-a = 0$.
        \item[Simmetria] Siano $a, b \in \Z$ tali che $a \congr b \Mod{n}$, ovvero $n \divides a - b$. Ma allora $n \divides b-a$, dunque $b \congr a \Mod{n}$.
        \item[Transitività] Siano $a, b, c \in \Z$ tali che \[
            a \congr b \Mod n, \quad b \congr c \Mod n.    
        \] Per definizione allora $n \divides a - b$ e $n \divides b-c$, ovvero esistono $k, h \in \Z$ tali che $a - b = nk$ e $b - c = nh$.
        Allora vale che \begin{align*}
            a - c &= a - b + b - c \\
            &= nk + nh \\
            &= n(k + h),
        \end{align*} ovvero $n \divides a - c$, da cui segue che $a \congr c \Mod n$. \qedhere
    \end{description}
\end{proof}

Le classi di equivalenza rispetto alla relazione di congruenza vengono dette \emph{classi di congruenza modulo $n$}, e si indicano con \[
    [a]_n \deq \set*{b \in \Z \given a \congr b \Mod n}.    
\] Quando il modulo è deducibile dal contesto possiamo usare la scrittura abbreviata $\eqcl a$.

\begin{proposition}[Caratterizzazione della relazione di congruenza] \label{prop:caratt_congr}
    Siano $a, b, n \in \Z$, $n \geq 2$. Allora sono fatti equivalenti:
    \begin{enumerate}[label={(\roman*)}]
        \item $a \congr b \Mod{n}$,
        \item esiste un $k_0 \in \Z$ tale che $a = b + nk_0$,
        \item la progressione aritmetica di ragione $n$ che passa per $a$ passa anche per il punto $b$, ovvero \[
            \left(nk + a\right)_{k \in \Z} = \left(nk + b\right)_{k \in \Z},
        \]
        \item $a$ e $b$ hanno lo stesso resto nella divisione euclidea per $n$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    Dimostriamo la catena di implicazioni $(i) \implies (ii) \implies (iii) \implies (iv) \implies (i)$.
    \begin{description}
        \item[($(i) \implies (ii)$)] Siccome $n \divides a-b$ allora per qualche $k_0 \in \Z$ vale che $a-b = nk_0$, ovvero $a = b + nk_0$.
        \item[($(ii) \implies (iii)$)] Per la $(ii)$ vale che $a = b+nk_0$, dunque \begin{align*}
            \left(nk + a\right)_{k \in \Z} &= \left(nk + nk_0 + b\right)_{k \in \Z} \\
            &= \left(n(k + k_0) + b\right)_{k \in \Z} \tag{pongo $h \deq k + k_0$}\\
            &= \left(nh + b\right)_{h \in \Z}.
        \end{align*}
        \item[($(iii) \implies (iv)$)] Per la divisione euclidea esistono $q, r \in \Z$ tali che $a = qn + r$ con $0 \leq r < n$.
        
        Dunque $r \in \left(nk + a\right)_{k \in \Z} = \left(nk + b\right)_{k \in \Z}$, ovvero esiste $k_0 \in \Z$ tale che $r = b + k_0n$, ovvero $b = (-k_0)n + r$. 

        Questa espressione è la divisione euclidea di $b$ per $n$ (infatti $0 \leq r < n$), dunque essendo essa unica (per il \autoref{th:esist_unic_div_euclidea}) segue che $r$ è il resto della divisione euclidea di $b$ per $n$.
        \item[($(iv) \implies (i)$)] Per ipotesi \[
            a = q_1n + r, \quad b = q_2n + r.    
        \] Ma allora \begin{align*}
            a - b &= q_1n + r - q_2n - r\\
            &= (q_1 + q_2)n,
        \end{align*} ovvero $n \divides a - b$, cioè $a \congr b \Mod n$. \qedhere
    \end{description}
\end{proof}

Sappiamo dalla sezione sulle relazioni di equivalenza che le classi di equivalenza da essa indotte sono a due a due disgiunte. Se scegliamo un rappresentante per ogni classe e lo includiamo nell'insieme $R$ dei rappresentanti, otteniamo che \[
    \Z = \bigsqcup_{a \in \R} [a]_n. 
\]

L'insieme dei rappresentati più naturale per la relazione di congruenza modulo $n$ è l'insieme $\set*{0, 1, \dots, n-1}$. Essi rappresentano tutte le classi di congruenza possibili e rappresentano tutte classi disgiunte, come ci viene garantito dal prossimo corollario.

\begin{corollary}
    I numeri $0, 1, \dots, n-1$ sono un insieme di rappresentati delle classi di congruenza modulo $n$, ovvero per ogni $m \in \Z$ esiste un unico $r \in \set*{0, \dots, n-1}$ tale che $m \congr r \Mod{n}$.
\end{corollary}
\begin{proof}
    Per la \autoref{prop:caratt_congr} sappiamo che $a \congr b \Mod n$ se e solo se $a$ e $b$ hanno lo stesso resto nella divisione euclidea per $n$.

    Dunque l'insieme dei possibili resti forma sicuramente un insieme di rappresentanti (ogni numero è congruo al suo resto); inoltre due resti distinti non possono essere nella stessa classe di congruenza, altrimenti dovrebbero essere uguali.
\end{proof}

\begin{definition}
    [Insieme $\Zmod{n}$]
    Sia $n \in \Z$, $n \geq 2$. Si indica con $\Zmod n$ l'insieme di tutte le classi di congruenza modulo $n$, ovvero l'insieme quoziente ottenuto da $\Z$ attraverso la relazione di congruenza modulo $n$: \begin{equation}
        \Zmod n \deq \set*{[0]_n, [1]_n, \dots, [n-1]_n} = \set*{[a]_n \given a \in \Z}.
    \end{equation}
\end{definition}

\begin{proposition}\label{prop:caratt_congr}
    Valgono le seguenti proprietà per le congruenze.
    \begin{enumerate}[label={(\arabic*)}]
        \item Se $a \congr b \Mod n$ e $c \congr d \mod n$ allora vale che \[
            a+c \congr b + d \Mod{n}, \quad ac \cong bd \Mod n.   
        \]
        \item Se $a \congr b \Mod n$ e $a \congr b \Mod m$ allora $a \congr b \Mod{\lcm{n}{m}}$.
        \item Se $a \congr b \Mod{n}$ allora $\gcd{a}{n} = \gcd{b}{n}$.
        \item Se $a \congr b \Mod n$ e $d \divides n$ allora $a \congr b \Mod d$.
        \item Se $ra \congr rb \Mod n$ allora $a \congr b \Mod{\nicefrac{n}{\gcd{n}{r}}}$.
        \item Se $a \congr b \Mod n$ allora $ka \congr kb \Mod n$ per ogni $k \in \Z$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    Dimostriamo singolarmente le varie proprietà.
    \begin{enumerate}[label={(\arabic*)}]
        \item Per ipotesi $a - b \divides n$, $c - d \divides n$, ovvero esistono $k, h \in \Z$ tali che \[
            a - b = nk, \quad c - d = nh,    
        \] da cui segue che 
        \begin{alignat*}{1}
            (a + c) - (b + d) &= (a - b) + (c - d) \\
            &= nk + nh = n(k+h) \\
            \implies a+c &\congr b+d \Mod n.\\
            ac &= (b + nk)(d +nh)\\
             &= bd + n(kd + hb + nkh) \\
            \implies &ac \congr bd \Mod n.
        \end{alignat*}
        \item Per ipotesi $n \divides a-b$, $m\divides a - b$, dunque per definizione di minimo comune multiplo \[
            \lcm{a}{b} \divides a - b    
        \] ovvero $a \congr b \Mod{\lcm{a}{b}}$.
        \item Per la \autoref{prop:caratt_congr} l'ipotesi equivale a dire che $a, b$ hanno lo stesso resto $r$ nella divisione euclidea per $n$, ovvero \[
            a = qn + r, \quad b = q^\prime n + r    
        \] per qualche $q, q^\prime \in \Z$.

        Allora segue che \begin{align*}
            \gcd{a}{n} = \gcd{qn + r}{n} \tag{per il \autoref{lem:mcd_diff}}\\
            = \gcd{r}{n} \tag{per il \autoref{lem:mcd_diff}}\\
            = \gcd{q^\prime n + r}{n}\\ 
            = \gcd{b}{n}.
        \end{align*}
        \item Per ipotesi $n \divides a - b$, ma $d \divides n$ dunque per transitività $d \divides a - b$, ovvero $a \congr b \Mod d$.
        \item Per ipotesi $n \divides r(a - b)$, ovvero $r(a-b) = kn$ per qualche $k \in \Z$. Dividendo entrambi i membri per $\gcd{n}{r}$ (che ovviamente divide sia il membro sinistro che il membro destro) otteniamo \[
            \frac{r}{\gcd{n}{r}}(a-b) = \frac{n}{\gcd{n}{r}}k,   
        \] ovvero \[
            \frac{n}{\gcd{n}{r}} \divides \frac{r}{\gcd{n}{r}}(a-b).
        \] Inoltre per LEMMA DA INSERIRE sappiamo che \[
            \gcd{\frac{r}{\gcd{n}{r}}}{\frac{n}{\gcd{n}{r}}} = 1,    
        \] dunque per LEMMA DA INSERIRE segue che \[
            \frac{n}{\gcd{n}{r}} \divides a - b,    
        \] da cui segue la tesi.
        \item Per la \autoref{prop:caratt_congr} l'ipotesi equivale a dire $a = b + nh$ per qualche $h \in \Z$. Moltiplicando tutto per $k$ segue che $ka = kb + n(kh)$, ovvero $ka \congr kb \Mod n$.
    \end{enumerate}
\end{proof}

\begin{example}
    Ogni numero è congruo alla somma delle sue cifre modulo $3$.

    Infatti se $n = a_k \dots a_1a_0$ in notazione posizionale, ovvero \[
        n = a_k\cdot 10^k + \dots + a_1\cdot 10 + a_0,   
    \] e sapendo che $10 \congr 1 \Mod 3$, segue che \begin{align*}
        n &\congr a_k\cdot 10^k + \dots + a_1\cdot 10 + a_0 \Mod{3}\\
        &\congr a_k \cdot 1^k + \dots + a_1 \cdot 1^1 + a_0\\
        &\congr a_k + \dots + a_1 + a_0.
    \end{align*}
\end{example}

